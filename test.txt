This is from Noon's fork.
